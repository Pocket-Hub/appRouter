"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _and = _interopRequireDefault(require("./core/condition/and.js"));
var _true = _interopRequireDefault(require("./core/condition/true.js"));
var _decision = _interopRequireDefault(require("./decision.js"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
/**
 * @typedef {import('./core/policyset.js').default} PolicySet
 */

class Authorizations {
  /**
   * @type {PolicySet}
   */
  __internal__policyset = null;
  /**
   * @type {PolicySet}
   */
  __internal__scopefilter__policyset = null;
  inquire(resource, action, input) {
    let result = new _decision.default();
    let scopeFilterResult = new _true.default();
    if (this.__internal__scopefilter__policyset !== null) {
      scopeFilterResult = this.__internal__scopefilter__policyset.evaluate(resource, action, input);
      if (scopeFilterResult.isFalse()) {
        result.__internal__condition = scopeFilterResult;
        return result;
      }
    }
    const policiesResult = this.__internal__policyset.evaluate(resource, action, input);
    if (policiesResult.isFalse()) {
      result.__internal__condition = policiesResult;
      return result;
    }
    if (scopeFilterResult.isTrue()) {
      result.__internal__condition = policiesResult;
      return result;
    }
    if (policiesResult.isTrue()) {
      result.__internal__condition = scopeFilterResult;
      return result;
    }
    result.__internal__condition = new _and.default([scopeFilterResult, policiesResult]);
    return result;
  }
}
exports.default = Authorizations;