"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _dcl = require("../../util/dcl.js");
class Value {
  /**
   * 
   * @param {*} dcnArgument 
   * @param {import("../dcn.js").Schema} schema 
   * @returns {Value}
   */
  static fromDcn(dcnArgument, schema) {
    const value = new Value();
    if (dcnArgument?.ref) {
      const reference = (0, _dcl.stringifyReference)(dcnArgument.ref);
      value.reference = reference;
    } else if (dcnArgument?.call) {
      return schema.getFunction(dcnArgument.call);
    } else {
      value.constant = dcnArgument;
    }
    return value;
  }
  constant = undefined;
  reference = undefined;

  /**
   * @returns {Value}
   */
  resolve(input = {}) {
    if (this.reference === undefined) {
      return this;
    }
    const resolvedValue = input[this.reference];
    if (resolvedValue === undefined) {
      const clone = new Value();
      clone.constant = this.constant;
      clone.reference = this.reference;
      return clone;
    } else {
      const resolved = new Value();
      resolved.constant = resolvedValue;
      return resolved;
    }
  }
  toDcn() {
    if (this.constant !== undefined) {
      return this.constant;
    }
    return {
      ref: (0, _dcl.parseReference)(this.reference)
    };
  }
}
exports.default = Value;