"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _condition = _interopRequireDefault(require("./condition.js"));
var _true = _interopRequireDefault(require("./true.js"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
class And extends _condition.default {
  /** @type string[]	 */
  variables = [];
  /** 
   * @type {Condition[]}
   */
  conditions = [];
  /**
   * @param {Condition[]} conditions 
   */
  constructor(conditions) {
    super();
    this.conditions = conditions;
    this.variables = conditions.reduce((p, c) => p.concat(c.variables), []);
  }
  /**
   * @param {Condition[]} conditions 
   * @returns {Condition}
   */
  static create(conditions) {
    if (conditions.length === 0) {
      return new _true.default();
    }
    if (conditions.length === 1) {
      return conditions[0];
    }
    return new And(conditions);
  }
  evaluate(input = {}) {
    const conditions = [];
    for (const c of this.conditions) {
      const evaluated = c.evaluate(input);
      if (evaluated.isFalse()) {
        return evaluated;
      }
      if (!evaluated.isTrue()) {
        conditions.push(evaluated);
      }
    }
    return And.create(conditions);
  }
  toDcn() {
    return {
      call: ["and"],
      args: this.conditions.map(c => c.toDcn())
    };
  }
}
exports.default = And;