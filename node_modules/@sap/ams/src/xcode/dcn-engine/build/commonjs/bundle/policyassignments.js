"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
class PolicyAssignments {
  #assignmentData = null;
  constructor(data) {
    this.#assignmentData = this.#flattenPrincipal2Policies(data.principal2policies);
  }
  #flattenPrincipal2Policies(p2p, prefix = "", flatmap = {}) {
    for (const p in p2p) {
      if (Array.isArray(p2p[p])) {
        flatmap[prefix + "\x1e" + p] = p2p[p];
      } else {
        flatmap = this.#flattenPrincipal2Policies(p2p[p], prefix ? prefix + "\x1e" + p : p, flatmap);
      }
    }
    return flatmap;
  }
  getPolicyNames(principal) {
    const principalId = principal.join("\x1e");
    return this.#assignmentData[principalId] ?? [];
  }
}
exports.default = PolicyAssignments;